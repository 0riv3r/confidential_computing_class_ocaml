# Homomorphic Encryption in ocaml_confidential_computing_class
OCaml Homomorphic Encryption code for the confidential computing class

---
author: Ofer Rivlin   
email: ofer.rivlin@intel.com
---
	
    $ cd he
	
## Dependencies
	$ opam install -y pyml zarith

To use sympy within OCaml I installed conda

    $ wget https://repo.anaconda.com/archive/Anaconda3-2023.09-0-Linux-x86_64.sh
    $ bash Anaconda3-2023.09-0-Linux-x86_64.sh 
    $ conda config --set auto_activate_base false
    $ conda update conda
    $ conda create -n ccc python=3.11
    $ conda activate ccc
    $ conda install -c anaconda sympy
    $ opam switch ccc

Work on OCaml code that uses sympy which is now in python-conda-ccc environment.


## Build
    $ dune build

## Execute
    $ dune exec ocaml_he_paillier
    $ dune exec ocaml_he_rsa


(ccc) ubuntu@ip-172-31-32-183:~/workspace/orivlin.confidential_computing_class_ocaml$ opam switch ccc
# Run eval $(opam env) to update the current shell environment                  
(ccc) ubuntu@ip-172-31-32-183:~/workspace/orivlin.confidential_computing_class_ocaml$ eval $(opam env)
(ccc) ubuntu@ip-172-31-32-183:~/workspace/orivlin.confidential_computing_class_ocaml$ cd he
(ccc) ubuntu@ip-172-31-32-183:~/workspace/orivlin.confidential_computing_class_ocaml/he$ dune build
(ccc) ubuntu@ip-172-31-32-183:~/workspace/orivlin.confidential_computing_class_ocaml/he$ dune exec ocaml_he_paillier
                                    
Prime p = 62299

Prime q = 41381

Keys generated:
n = 2577994919

g = 2577994920

Plaintext m1: 72
Encrypted m1: 4677618862314046836

Plaintext m2: 28
Encrypted m2: 3535629067570940244

Encrypted Sum: 5588558290548874050

Decrypted Sum: 100


(ccc) ubuntu@ip-172-31-32-183:~/workspace/orivlin.confidential_computing_class_ocaml/he$ dune exec ocaml_he_rsa
                                    
Prime p = 30853879864058609867972088236678445845936478798357367135145246079148393001480480153467979886353529489605200565962985756540596033937202896495304853225368800021410594147898620580253621130549415814349428019816117704255315127214475907403767171208046633190689756231045282977146218878171826410318470482505530856241265278221663938660507885885007425739322610726348224940884773770988326608626722487613472708370084278337532759922945945158386140977485782785348012471822411587676674931753727751740322008104062292383738393970159190814886670981993770719418856567511385979295222470775107238773428602382388363187359324234405189849569

Prime q = 22129030882761813185489949643814727669657406034417204383172116368002720909280232408560755385536728448776324701300642336222683935946097179558920387009621823177368995413168781339924348518750884715480926567356217043749666351161806660293073862001548376452266833967359057093798160335209256704659439748712396343426501029090146874246036922078544008912553468435872239777541335011813675186857251735333206264661991161840150203936934169762828028226599006962769819104777351309749243439955967893667614555985435484873150900890862278052944371057240180855400118272437070438764114131845295611034071039028218618870047442037119030747369

Keys generated:
n = 682766460364775832130306987363376413336601230860385321455053326038110241079860454000835832695596615147222289506919928475027203177596850260466579951586420596792180473325343710293180165183096793440931652833328212922446114526432004856979693446974999345196819532416596819891872824006657831895746096425474230085963221094562090537862456236918912857092802685924278841485833084414854187548797448525029761652890337664119807396787810413320595575968312521086808217775579712027211224568820298103555276945128416915063025273059387864679225701775226848391017560743850647274441814797631776435919729743686882211184154304655683884096941848393543200088165559637461449022923113177934250506646701626683679252016041066882065436599695262216937189750088302056801963758356602337565571191699353782234954878735380351703274698501521257184446257239308910865586047958086240886987406665331001156030709213991756095284447350930402831953219198905302196086320201139312162671810629827828041945101796344017349862641762276175905218668702617701423177765355694550553366523006880973228803640387350426938030479720100443926772747792102734204581236012656596050751851813167493466011828601428438621798028729386443536260495008836128177412345085492003879794037320423019530752533961

e = 682766460364775832130306987363376413336601230860385321455053326038110241079860454000835832695596615147222289506919928475027203177596850260466579951586420596792180473325343710293180165183096793440931652833328212922446114526432004856979693446974999345196819532416596819891872824006657831895746096425474230085963221094562090537862456236918912857092802685924278841485833084414854187548797448525029761652890337664119807396787810413320595575968312521086808217775579712027211224568820298103555276945128416915063025273059387864679225701775226848391017560743850647274441814797631776435919729743686882211184154304655683884096888865482796379665112097599580955849407519293101475935128384264236528138105280354320036701327805004278555664482824673964038683788473302261511345951464363159036175289174312949783096728852220956654615902652136576117581066479709958319290565632121406146387752623793351755213502971717021748838241288674084268886652434832000351858904085019864490510449920264855129397923336167393103216873218643478476498792323619110375683559147000858307589471183265637189912648143500681029346829420393038559173299448567098273494962518306471997143997559389204670223209754546495079842435672233507774562537585850593272811979913656748006531937023

Plaintext m1: 25
Encrypted m1: 245795925731319299566910515450815508801176443109738715723819197373719686788749763440300899770414781453000024222491174251009793143934866093767968782571111414845184970397123735705544859465914845638735395019998156652080601229515521748512689640910999764270855031669974855161074216642396819482468594713170722830946759594042352593630484245290808628553408966932740382934899910389347507517567081469010714195040521559083130662843611748795414407348592507591250958399208696329796040844775307317279899700246230089422689098301379631284521252639081665420766321867786233018799053327147439516931102707727277596026295549676046198274899065421675552031739601469486121648252320744056330182392812585606124530725774784077543557175890294398097388310031788740448706953008376841523605629011767361604583756344736926613178891460547652586400652606151207911610977264911046719315466399519160416171055317037032194302401046334945019503158911605908790591075272410152378561851826738018095100236646683846245950551034419423325878720732942372512343995528050038199211948282477150362369310539446153697690972699236159813638189205156984313649244964556374578270666652740297647764258296514237903847290342579119673053778203181006143868444230777121396725853435352287031070912226

Plaintext m2: 4
Encrypted m2: 512074845273581874097730240522532310002450923145288991091289994528582680809895340500626874521697461360416717130189946356270402383197637695349934963689815447594135354994007782719885123887322595080698739624996159691834585894824003642734770085231249508897614649312447614918904618004993373921809572319105672564472415820921567903396842177689184642819602014443209131114374813311140640661598086393772321239667753248089855547590857809990446681976234390815106163331684784020408418426615223577666457708846312686297268954794540898509419276331420136293263170557887985455831361098223832326939797307765161658388115728491762913072706386295157400066124169728096086767192334883450687879985026220012759439012030800161549077449771446662702892312566226542601472818767451753174178393774515336676216159051535263777456023876140942888334692929481683149189535968564680665240554998998250867023031910493817071463335513197802123964914399178976647064740150854484122003857972370871031458826347258013012396981321707131928914001526963276067383324016770912915024892255160729921602730290512820203522859790075332945079560844077050653435927009492447038063888859875620099508871451071328966348521547039832652195371256627096133059258814119002909845527990317264648064400471

Homomorphic encrypted Product of m1 and m2: 402832211615217740956881122544392083868594726207627339658481462362485042237117667860493141290402002936861150809082757800266049874782141653675282171435988152107386479261952789072976297458027108130149675171663645624243207570594882865618019133715249613666123524125792123736204966163928120818490196891029795750718300445791633417338849179782158585684753584695324516476641519804763970653790494629767559375205299221830686364104808143859151389821304387441216848487592030096054622495603975881097613397625765979887184911105038840160743164047383840550700360838871881891920670730602748097192640548775260504598651039746853491617195690552190488052017680186102254923524636774981207798921553959743370758689464229460418607593820204707992941952552098213513158617430395379163687003102618731518623378453874407504932072115897541738823291771192257410695768295270882123322569932545290682058118436255136096217823937048937670852399327354128295690928918672194175976368271598418544747610059842970236418958639742943784079014534544443839674881559859784826486248574059774204994147828536751893437983034859261916795921197340613180702929247467391669943592569768821144946978874842778786860836950338001686393692055213315624673283600440282289078482019049581523143995037

Decrypted Product of m1 and m2: 100
(ccc) ubuntu@ip-172-31-32-183:~/workspace/orivlin.confidential_computing_class_ocaml/he$ 